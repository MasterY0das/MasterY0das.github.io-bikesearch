<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BikeMatch - Find Your Perfect Ride</title>
    <!-- Add Lottie animation library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.9.6/lottie.min.js"></script>
    <!-- Add dotLottie player component -->
    <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
    <style>
        :root {
            --primary: #E64833; /* Coral red */
            --primary-dark: #C93A28; /* Darker coral */
            --secondary: #244855; /* Dark teal */
            --accent: #90AEAD; /* Sage green */
            --dark: #1A3640; /* Darker teal */
            --light: #FBE9D0; /* Cream */
            --success: #5A8F7B; /* Green */
            --warning: #F2C14E; /* Yellow */
            --danger: #E64833; /* Coral red */
            --gray-light: #F0E6D8; /* Light cream */
            --gray: #D0C5B3; /* Medium cream */
            --text-dark: #874F41; /* Brown */
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--text-dark);
            line-height: 1.6;
            background-image: url('https://images.unsplash.com/photo-1541625602330-2277a4c46182?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-blend-mode: overlay;
            background-color: rgba(251, 233, 208, 0.9); /* Cream color with opacity */
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--gray-light);
            position: relative; /* For progress bar positioning */
            overflow-x: hidden; /* Prevent horizontal scroll */
        }
        
        /* Intro animation section */
        .intro-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, var(--light), white);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s ease-out;
            pointer-events: auto; /* Ensure it captures events */
        }
        
        /* When intro is fading out, let events pass through */
        .intro-section.fading {
            pointer-events: none;
        }
        
        .animation-container {
            width: 90%;
            max-width: 600px;
            height: 350px;
            margin-bottom: 2rem;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .animation-container svg {
            width: 100%;
            height: 100%;
        }
        
        .intro-title {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }
        
        .intro-subtitle {
            font-size: 1.2rem;
            color: var(--secondary);
            text-align: center;
            max-width: 600px;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease-out 1s forwards;
        }
        
        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            animation: fadeIn 1s ease-out 2s forwards;
        }
        
        .scroll-indicator p {
            margin-bottom: 10px;
            color: var(--secondary);
            font-weight: 500;
        }
        
        .scroll-arrow {
            width: 30px;
            height: 30px;
            border: solid var(--primary);
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
            animation: bounce 2s infinite;
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0) rotate(45deg);
            }
            40% {
                transform: translateY(-10px) rotate(45deg);
            }
            60% {
                transform: translateY(-5px) rotate(45deg);
            }
        }
        
        .skip-intro {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--gray);
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--secondary);
            transition: all 0.3s;
        }
        
        .skip-intro:hover {
            background: white;
            color: var(--primary);
        }
        
        /* Progress bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            z-index: 9999;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            width: 0%;
            border-radius: 0 3px 3px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: width 0.1s ease;
        }
        
        /* Custom scrollbar for Webkit browsers */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--secondary), var(--accent));
            border-radius: 10px;
            border: 2px solid var(--gray-light);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
        
        /* Class for when body scrolling is disabled */
        .no-scroll {
            overflow: hidden;
        }
        
        /* Main content wrapper to add padding for fixed intro */
        .main-content {
            padding-top: 0;
            transition: padding-top 0.5s ease;
            background: linear-gradient(135deg, var(--light), white);
        }
        
        header {
            background: var(--dark);
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
            background-image: linear-gradient(to right, var(--primary-dark), var(--primary));
            position: relative;
            overflow: hidden;
            border-radius: 0 0 20px 20px;
            margin: 0 10px 20px;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('https://images.unsplash.com/photo-1507035895480-2b3156c31fc8?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
            opacity: 0.1;
            z-index: 0;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            margin-bottom: 0.3rem;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(to right, #fff, var(--light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: none;
            position: relative;
            display: inline-block;
        }
        
        h1::after {
            content: 'BikeMatch';
            position: absolute;
            left: 0;
            top: 0;
            z-index: 1;
            color: var(--primary);
            
            opacity: 0;
        }
        
        .subtitle {
            font-weight: 300;
            opacity: 0.9;
            font-size: 1rem;
            color: #fff;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 2rem;
            margin-bottom: 2rem;
            border: none;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        
        .card::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background-image: url('https://cdn-icons-png.flaticon.com/512/2972/2972185.png');
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0.05;
            z-index: 0;
        }
        
        .form-group {
            margin-bottom: 1.2rem;
            position: relative;
            z-index: 1;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--secondary);
        }
        
        select, input {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03) inset;
        }
        
        select:focus, input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(230, 72, 51, 0.15);
            outline: none;
        }
        
        .slider-container {
            margin-top: 0.5rem;
            position: relative;
            padding: 0.5rem 0;
        }
        
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;  
            background: var(--gray-light);
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%; 
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.15);
        }
        
        .slider::-moz-range-thumb {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            border: none;
        }
        
        .slider::-moz-range-thumb:hover {
            transform: scale(1.15);
        }
        
        .slider-value {
            text-align: center;
            font-weight: 600;
            margin-top: 0.5rem;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .btn {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(230, 72, 51, 0.3);
            display: block;
            margin: 2rem auto 0.5rem;
            min-width: 220px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            background: linear-gradient(to right, #F05A45, var(--primary));
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(230, 72, 51, 0.4);
        }
        
        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }
        
        .btn:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .bike-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .bike-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.4s;
            cursor: pointer;
            border: none;
            position: relative;
        }
        
        .bike-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }
        
        .bike-image {
            height: 220px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            border-bottom: 1px solid var(--gray-light);
            position: relative;
            overflow: hidden;
        }
        
        .bike-image::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(to top, rgba(255,255,255,0.8), transparent);
            z-index: 1;
        }
        
        .bike-image img {
            max-width: 100%;
            max-height: 180px;
            object-fit: contain;
            transition: transform 0.3s;
        }
        
        .bike-card:hover .bike-image img {
            transform: scale(1.05);
        }
        
        .bike-details {
            padding: 1.2rem;
            background: linear-gradient(to bottom, white, #f9f9f9);
        }
        
        .bike-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: var(--text-dark);
        }
        
        .bike-year {
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }
        
        .bike-manufacturer {
            color: #717171;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }
        
        .bike-spec {
            display: flex;
            justify-content: space-between;
            border-top: 1px solid var(--gray-light);
            padding-top: 1rem;
            margin-top: 0.5rem;
        }
        
        .bike-spec span {
            display: block;
        }
        
        .spec-label {
            font-size: 0.75rem;
            color: #717171;
        }
        
        .spec-value {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .match-score {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(to right, var(--secondary), #1A3640);
            color: white;
            padding: 0.5rem 0.9rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.85rem;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            z-index: 2;
        }
        
        .free-shipping {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.8rem;
            z-index: 2;
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        
        .loading {
            text-align: center;
            margin: 3rem 0;
            padding: 2rem;
            background: rgba(255,255,255,0.9);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border-left-color: var(--primary);
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .preferences-summary {
            background: linear-gradient(135deg, white, var(--gray-light));
            border-left: none;
            border-radius: 16px;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.06);
            position: relative;
            overflow: hidden;
        }
        
        .preferences-summary::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 5px;
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            border-radius: 5px;
        }
        
        .preferences-summary h3 {
            color: var(--secondary);
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .preferences-summary h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 2px;
            background-color: var(--primary);
        }
        
        .preferences-summary ul {
            list-style-type: none;
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }
        
        .preferences-summary li {
            background-color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            font-size: 0.95rem;
            border: none;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        
        .preferences-summary li:hover {
            box-shadow: 0 5px 12px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        
        .error {
            color: var(--danger);
            margin-top: 0.5rem;
            font-weight: 500;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            overflow-y: hidden;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2.5rem;
            border-radius: 20px;
            max-width: 850px;
            position: relative;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            animation: modalFadeIn 0.4s;
            max-height: 85vh;
            overflow-y: auto;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--gray-light);
        }
        
        .modal-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .modal-content::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 8px;
        }
        
        .modal-content::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
            border-radius: 8px;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #modal-content {
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: #aaa;
            transition: color 0.2s;
            z-index: 10;
        }
        
        .close-modal:hover {
            color: var(--text-dark);
        }
        
        .section-title {
            color: var(--secondary);
            margin: 2rem 0 1rem;
            font-size: 1.5rem;
            position: relative;
            padding-bottom: 0.8rem;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            border-radius: 3px;
        }
        
        .similar-bikes {
            display: flex;
            overflow-x: auto;
            gap: 1.2rem;
            padding: 1.2rem 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--gray-light);
        }
        
        .similar-bikes::-webkit-scrollbar {
            height: 8px;
        }
        
        .similar-bikes::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 10px;
        }
        
        .similar-bikes::-webkit-scrollbar-thumb {
            background: linear-gradient(to right, var(--secondary), var(--accent));
            border-radius: 10px;
        }
        
        .similar-bike-card {
            min-width: 220px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid var(--gray-light);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .similar-bike-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 12px rgba(0,0,0,0.15);
            border-color: var(--primary);
        }
        
        .toggle-container {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 35px;
            vertical-align: middle;
            margin-left: 10px;
        }
        
        .toggle-checkbox {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e0e0e0;
            transition: .4s;
            border-radius: 30px;
        }
        
        .toggle-label:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .toggle-checkbox:checked + .toggle-label {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
        }
        
        .toggle-checkbox:checked + .toggle-label:before {
            transform: translateX(30px);
        }
        
        .price-tag {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--danger);
            margin: 0.7rem 0;
            display: inline-block;
            position: relative;
        }
        
        .price-tag::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(to right, var(--danger), transparent);
        }
        
        .rating {
            color: var(--primary);
            font-size: 0.9rem;
            margin-bottom: 0.7rem;
            display: flex;
            align-items: center;
        }
        
        .rating::before {
            content: '';
            display: inline-block;
            width: 16px;
            height: 16px;
            background-image: url('https://cdn-icons-png.flaticon.com/512/1828/1828884.png');
            background-size: contain;
            margin-right: 5px;
            opacity: 0.9;
        }
        
        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            border-bottom: none;
            padding-bottom: 1rem;
            position: relative;
        }
        
        .filters-header h2 {
            color: var(--secondary);
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .filters-header h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            border-radius: 3px;
        }
        
        .filters-header p {
            color: var(--text-dark);
            font-size: 1.1rem;
            opacity: 0.8;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            border-bottom: none;
            padding-bottom: 1rem;
            position: relative;
        }
        
        .results-header h2 {
            color: var(--secondary);
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .results-header h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            border-radius: 3px;
        }
        
        .sort-select {
            width: auto;
            padding: 0.6rem 2.5rem 0.6rem 1rem;
            margin-left: 0.5rem;
            font-size: 0.95rem;
            background-color: white;
            border: none;
            border-radius: 50px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            appearance: none;
            background-image: url('https://cdn-icons-png.flaticon.com/512/32/32195.png');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
            transition: all 0.3s;
        }
        
        .sort-select:hover {
            box-shadow: 0 5px 12px rgba(0,0,0,0.12);
        }
        
        .radio-group {
            display: flex;
            gap: 0.8rem;
            margin-top: 0.7rem;
            flex-wrap: wrap;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            background-color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .radio-option:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .radio-option.selected {
            background: linear-gradient(to right, rgba(230, 72, 51, 0.1), rgba(230, 72, 51, 0.05));
            border: 1px solid rgba(230, 72, 51, 0.2);
            color: var(--primary);
            font-weight: 500;
        }
        
        .radio-option input[type="radio"] {
            appearance: none;
            -webkit-appearance: none;
            width: 0;
            height: 0;
            margin: 0;
            padding: 0;
            position: absolute;
            opacity: 0;
        }
        
        .radio-option label {
            font-weight: normal;
            font-size: 0.85rem;
            cursor: pointer;
            transition: color 0.2s;
            margin: 0;
            padding: 0.2rem 0;
        }
        
        .radio-option.selected label {
            color: var(--primary);
        }
        
        @media (max-width: 768px) {
            .bike-list {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 1.5rem;
            }
            
            .preferences-summary ul {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.8rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .btn {
                width: 100%;
            }
            
            .intro-title {
                font-size: 2.2rem;
            }
            
            .animation-container {
                height: 200px;
            }
        }
        
        .price-tag::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(to right, var(--danger), transparent);
        }
        
        .purchase-options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-top: 1rem;
        }
        
        .purchase-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: white;
        }
        
        .purchase-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .purchase-btn.amazon {
            background-color: #232F3E;
            border: 1px solid #232F3E;
        }
        
        .purchase-btn.amazon:hover {
            background-color: #131921;
        }
        
        .purchase-btn.rei {
            background-color: #1A472A;
            border: 1px solid #1A472A;
        }
        
        .purchase-btn.rei:hover {
            background-color: #0D3320;
        }
        
        .purchase-btn.cc {
            background-color: #D32F2F;
            border: 1px solid #D32F2F;
        }
        
        .purchase-btn.cc:hover {
            background-color: #B71C1C;
        }
        
        .purchase-btn.brand {
            background-color: var(--secondary);
            border: 1px solid var(--secondary);
        }
        
        .purchase-btn.brand:hover {
            background-color: var(--dark);
        }
        
        .purchase-btn.used {
            background-color: #4CAF50;
            border: 1px solid #4CAF50;
        }
        
        .purchase-btn.used:hover {
            background-color: #388E3C;
        }
    </style>
</head>
<body>
    <!-- Intro section will be added by JavaScript -->
    
    <div class="main-content">
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
    <header>
        <div class="header-content">
            <h1>BikeMatch</h1>
            <p class="subtitle">Find your perfect ride with personalized recommendations</p>
        </div>
    </header>
    
    <div class="container">
        <div class="card">
            <div class="filters-header">
                <h2>Tell us your preferences</h2>
                <p>We'll find the perfect match for you</p>
            </div>
            
            <form id="preferences-form">
                <div class="form-group">
                    <label for="manufacturer">Preferred Manufacturer</label>
                    <select id="manufacturer">
                        <option value="">Any manufacturer</option>
                        <!-- Will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="year-slider">Year: <span id="year-value">2023</span></label>
                    <div class="slider-container">
                        <input type="range" min="2000" max="2025" value="2023" class="slider" id="year-slider">
                    </div>
                    <div style="display: flex; align-items: center; margin-top: 0.5rem;">
                        <label for="any-year" style="display: inline; margin-right: 0.5rem;">Any year</label>
                        <div class="toggle-container">
                            <input type="checkbox" id="any-year" class="toggle-checkbox" checked>
                            <label for="any-year" class="toggle-label"></label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="bike-type">Bike Type</label>
                    <select id="bike-type">
                        <option value="">Any type</option>
                        <option value="road">Road</option>
                        <option value="mountain">Mountain</option>
                        <option value="hybrid">Hybrid</option>
                        <option value="commuter">Commuter</option>
                        <option value="touring">Touring</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="price-range">Price Range</label>
                    <select id="price-range">
                        <option value="">Any price</option>
                        <option value="budget">Budget (Under $500)</option>
                        <option value="mid">Mid-range ($500-$1000)</option>
                        <option value="premium">Premium ($1000-$2000)</option>
                        <option value="high-end">High-end ($2000+)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Gender Preference</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="gender-male" name="gender" value="male">
                            <label for="gender-male">Male</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="gender-female" name="gender" value="female">
                            <label for="gender-female">Female</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="gender-any" name="gender" value="" checked>
                            <label for="gender-any">No Preference</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn" id="find-bikes-btn">Find My Perfect Bike</button>
            </form>
        </div>
        
        <div id="results-section" style="display: none;">
            <div class="preferences-summary" id="preferences-summary">
                <!-- Will be populated by JavaScript -->
            </div>
            
            <div class="results-header">
                <h2>Recommended Bikes For You</h2>
                <div>
                    <label for="sort-by" style="display: inline;">Sort by:</label>
                    <select id="sort-by" class="sort-select">
                        <option value="match">Best Match</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="year">Newest First</option>
                    </select>
                </div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Finding your perfect bikes...</p>
            </div>
            
            <div class="bike-list" id="bike-list">
                <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="bike-modal">
        <div class="modal-content">
            <span class="close-modal" id="close-modal">&times;</span>
            <div id="modal-content">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let manufacturers = [];
        let recommendedBikes = [];
        let userPreferences = {};
        
        // Constants
        const BIKEBOOK_API = 'https://bikebook.io';
        const BIKE_IMAGES = {
            'road': 'https://images.unsplash.com/photo-1485965120184-e220f721d03e?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
            'mountain': 'https://images.unsplash.com/photo-1544191696-102dbdaeeaa0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
            'hybrid': 'https://images.unsplash.com/photo-1507035895480-2b3156c31fc8?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
            'commuter': 'https://images.unsplash.com/photo-1529422643029-d4585747aaf2?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
            'touring': 'https://images.unsplash.com/photo-1571333250630-f0230c320b6d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
            'default': 'https://images.unsplash.com/photo-1511994298241-608e28f14fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
        };
        
        // Prices for mock data
        const PRICE_RANGES = {
            'budget': { min: 299, max: 499 },
            'mid': { min: 500, max: 999 },
            'premium': { min: 1000, max: 1999 },
            'high-end': { min: 2000, max: 5000 }
        };
        
        // DOM Elements
        let manufacturerSelect;
        let yearSlider;
        let yearValue;
        let anyYearCheckbox;
        let bikeTypeSelect;
        let priceRangeSelect;
        let preferencesForm;
        let findBikesBtn;
        let resultsSection;
        let preferencesSummary;
        let bikeList;
        let loadingElement;
        let bikeModal;
        let closeModal;
        let modalContent;
        let sortBySelect;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize DOM elements after they're available
            initializeDOMElements();
            
            // Initialize the application
            initialize();
        });
        
        // Initialize DOM elements
        function initializeDOMElements() {
            manufacturerSelect = document.getElementById('manufacturer');
            yearSlider = document.getElementById('year-slider');
            yearValue = document.getElementById('year-value');
            anyYearCheckbox = document.getElementById('any-year');
            bikeTypeSelect = document.getElementById('bike-type');
            priceRangeSelect = document.getElementById('price-range');
            preferencesForm = document.getElementById('preferences-form');
            findBikesBtn = document.getElementById('find-bikes-btn');
            resultsSection = document.getElementById('results-section');
            preferencesSummary = document.getElementById('preferences-summary');
            bikeList = document.getElementById('bike-list');
            loadingElement = document.getElementById('loading');
            bikeModal = document.getElementById('bike-modal');
            closeModal = document.getElementById('close-modal');
            modalContent = document.getElementById('modal-content');
            sortBySelect = document.getElementById('sort-by');
        }
        
        function initialize() {
            // Add event listeners
            preferencesForm.addEventListener('submit', handleFormSubmit);
            closeModal.addEventListener('click', () => {
                bikeModal.style.display = 'none';
                document.body.classList.remove('no-scroll'); // Re-enable scrolling
            });
            window.addEventListener('click', (e) => {
                if (e.target === bikeModal) {
                    bikeModal.style.display = 'none';
                    document.body.classList.remove('no-scroll'); // Re-enable scrolling
                }
            });
            
            // Progress bar functionality
            window.addEventListener('scroll', updateProgressBar);
            
            // Year slider functionality
            yearSlider.addEventListener('input', function() {
                yearValue.textContent = this.value;
                // Uncheck "Any year" when slider is moved
                anyYearCheckbox.checked = false;
            });
            
            // Any year checkbox functionality
            anyYearCheckbox.addEventListener('change', function() {
                yearSlider.disabled = this.checked;
                yearSlider.style.opacity = this.checked ? "0.5" : "1";
            });
            
            // Sort by select functionality
            sortBySelect.addEventListener('change', sortBikes);
            
            // Set initial slider state
            yearSlider.disabled = anyYearCheckbox.checked;
            yearSlider.style.opacity = anyYearCheckbox.checked ? "0.5" : "1";
            
            // Initialize radio button styling
            setupGenderRadioButtons();
            
            // Fetch manufacturers and populate select
            fetchManufacturers();
        }
        
        // Setup gender radio buttons with enhanced styling
        function setupGenderRadioButtons() {
            const radioOptions = document.querySelectorAll('.radio-option');
            const radioInputs = document.querySelectorAll('.radio-option input[type="radio"]');
            
            // Add selected class to the checked radio button's parent
            radioInputs.forEach(input => {
                if (input.checked) {
                    input.closest('.radio-option').classList.add('selected');
                }
                
                input.addEventListener('change', function() {
                    // Remove selected class from all options
                    radioOptions.forEach(option => {
                        option.classList.remove('selected');
                    });
                    
                    // Add selected class to the checked option
                    if (this.checked) {
                        this.closest('.radio-option').classList.add('selected');
                    }
                });
            });
            
            // Add click event to the radio option div to improve UX
            radioOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                    
                    // Trigger the change event manually
                    const event = new Event('change');
                    radio.dispatchEvent(event);
                });
            });
        }
        
        // Update progress bar based on scroll position
        function updateProgressBar() {
            const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercentage = (scrollTop / scrollHeight) * 100;
            
            document.getElementById('progress-bar').style.width = scrollPercentage + '%';
        }
        
        // Fetch all manufacturers from the API
        async function fetchManufacturers() {
            try {
                const response = await fetch(`${BIKEBOOK_API}/assets/index.json`);
                if (!response.ok) {
                    throw new Error('Failed to fetch manufacturers');
                }
                
                const data = await response.json();
                manufacturers = Object.keys(data).sort();
                
                // Populate the manufacturer dropdown
                manufacturers.forEach(manufacturer => {
                    const option = document.createElement('option');
                    option.value = manufacturer;
                    option.textContent = manufacturer;
                    manufacturerSelect.appendChild(option);
                });
            } catch (error) {
                console.error('Error fetching manufacturers:', error);
                // Use mock data if API fails
                const mockManufacturers = ['Trek', 'Specialized', 'Giant', 'Cannondale', 'Fuji', 'Bianchi', 'Cervelo', 'Scott', 'Santa Cruz', 'Surly'];
                mockManufacturers.forEach(manufacturer => {
                    const option = document.createElement('option');
                    option.value = manufacturer;
                    option.textContent = manufacturer;
                    manufacturerSelect.appendChild(option);
                });
            }
        }
        
        // Handle form submission
        function handleFormSubmit(e) {
            e.preventDefault();
            
            // Get user preferences
            userPreferences = {
                manufacturer: manufacturerSelect.value,
                year: anyYearCheckbox.checked ? "" : yearSlider.value,
                bikeType: bikeTypeSelect.value,
                priceRange: priceRangeSelect.value,
                gender: document.querySelector('input[name="gender"]:checked').value
            };
            
            // Reset recommended bikes
            recommendedBikes = [];
            
            // Show results section and loading spinner
            resultsSection.style.display = 'block';
            loadingElement.style.display = 'block';
            bikeList.innerHTML = '';
            
            // Display preferences summary
            updatePreferencesSummary();
            
            // Get bike recommendations
            getBikeRecommendations();
            
            // Scroll to results
            setTimeout(() => {
                resultsSection.scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
        
        // Update the preferences summary section
        function updatePreferencesSummary() {
            let summaryHTML = '<h3>Your Preferences</h3><ul>';
            
            if (userPreferences.manufacturer) {
                summaryHTML += `<li><strong>Brand:</strong> ${userPreferences.manufacturer}</li>`;
            } else {
                summaryHTML += `<li><strong>Brand:</strong> Any</li>`;
            }
            
            if (userPreferences.year) {
                summaryHTML += `<li><strong>Year:</strong> ${userPreferences.year}</li>`;
            } else {
                summaryHTML += `<li><strong>Year:</strong> Any</li>`;
            }
            
            if (userPreferences.bikeType) {
                const bikeTypeText = bikeTypeSelect.options[bikeTypeSelect.selectedIndex].text;
                summaryHTML += `<li><strong>Type:</strong> ${bikeTypeText}</li>`;
            } else {
                summaryHTML += `<li><strong>Type:</strong> Any</li>`;
            }
            
            if (userPreferences.priceRange) {
                const priceRangeText = priceRangeSelect.options[priceRangeSelect.selectedIndex].text;
                summaryHTML += `<li><strong>Price:</strong> ${priceRangeText}</li>`;
            } else {
                summaryHTML += `<li><strong>Price:</strong> Any</li>`;
            }
            
            if (userPreferences.gender) {
                summaryHTML += `<li><strong>Gender:</strong> ${userPreferences.gender.charAt(0).toUpperCase() + userPreferences.gender.slice(1)}</li>`;
            } else {
                summaryHTML += `<li><strong>Gender:</strong> No Preference</li>`;
            }
            
            summaryHTML += '</ul>';
            preferencesSummary.innerHTML = summaryHTML;
        }
        
        // Get bike recommendations based on user preferences
        async function getBikeRecommendations() {
            try {
                // If manufacturer is selected, get models for that manufacturer
                if (userPreferences.manufacturer) {
                    let url = `${BIKEBOOK_API}/model_list?manufacturer=${encodeURIComponent(userPreferences.manufacturer)}`;
                    
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Failed to fetch bike models');
                    }
                    
                    const models = await response.json();
                    
                    // Get detailed information for each model
                    // Process models and create recommendations
                    for (const model of models.slice(0, 20)) { // Limit to 20 models for performance
                        try {
                            const modelUrl = `${BIKEBOOK_API}/model_detail?manufacturer=${encodeURIComponent(userPreferences.manufacturer)}&model=${encodeURIComponent(model)}`;
                            const modelResponse = await fetch(modelUrl);
                            
                            if (!modelResponse.ok) {
                                continue;
                            }
                            
                            const modelData = await modelResponse.json();
                            
                            // Filter by year if specified
                            if (userPreferences.year && modelData.year !== parseInt(userPreferences.year)) {
                                continue;
                            }
                            
                            // Create bike object
                            const bike = {
                                id: Math.random().toString(36).substr(2, 9),
                                name: model,
                                manufacturer: userPreferences.manufacturer,
                                year: modelData.year || 2023,
                                type: modelData.type || getRandomBikeType(),
                                price: getRandomPrice(userPreferences.priceRange),
                                specs: {
                                    weight: Math.floor(Math.random() * 10) + 5 + " kg",
                                    material: getRandomMaterial(),
                                    gears: Math.floor(Math.random() * 24) + 1
                                },
                                matchScore: calculateMatchScore(modelData),
                                image: getBikeImage(modelData.type),
                                gender: modelData.gender || getRandomGender(),
                                freeShipping: Math.random() > 0.5
                            };
                            
                            // Filter by bike type if specified
                            if (userPreferences.bikeType && bike.type !== userPreferences.bikeType) {
                                continue;
                            }
                            
                            // Filter by gender if specified
                            if (userPreferences.gender && bike.gender !== userPreferences.gender && bike.gender !== 'unisex') {
                                continue;
                            }
                            
                            recommendedBikes.push(bike);
                        } catch (error) {
                            console.error(`Error processing model ${model}:`, error);
                        }
                    }
                } else {
                    // If no manufacturer selected, generate random recommendations
                    generateRandomRecommendations();
                }
                
                // If no bikes found, generate random recommendations
                if (recommendedBikes.length === 0) {
                    generateRandomRecommendations();
                }
                
                // Sort bikes by match score
                sortBikes();
                
                // Hide loading spinner and display bikes
                loadingElement.style.display = 'none';
                displayBikes();
                
            } catch (error) {
                console.error('Error getting bike recommendations:', error);
                // Generate random recommendations if API fails
                generateRandomRecommendations();
                sortBikes();
                loadingElement.style.display = 'none';
                displayBikes();
            }
        }
        
        // Generate random bike recommendations
        function generateRandomRecommendations() {
            const mockManufacturers = [
                'Trek', 'Specialized', 'Giant', 'Cannondale', 'Scott', 
                'Santa Cruz', 'Cervlo', 'Bianchi', 'Kona', 'Orbea',
                'Pinarello', 'BMC', 'Felt', 'GT', 'Marin'
            ];
            
            const mockModels = [
                'Domane', 'Emonda', 'Madone', 'Checkpoint', 'Fuel EX',
                'Tarmac', 'Roubaix', 'Diverge', 'Epic', 'Stumpjumper',
                'Defy', 'TCR', 'Propel', 'Revolt', 'Anthem',
                'SuperSix', 'Synapse', 'CAAD', 'Topstone', 'Scalpel',
                'Addict', 'Spark', 'Scale', 'Genius', 'Contessa'
            ];
            
            // Generate 15 random bikes
            for (let i = 0; i < 15; i++) {
                const manufacturer = userPreferences.manufacturer || mockManufacturers[Math.floor(Math.random() * mockManufacturers.length)];
                const bikeType = userPreferences.bikeType || getRandomBikeType();
                const year = userPreferences.year || Math.floor(Math.random() * 10) + 2015;
                const gender = userPreferences.gender || getRandomGender();
                
                const bike = {
                    id: Math.random().toString(36).substr(2, 9),
                    name: mockModels[Math.floor(Math.random() * mockModels.length)],
                    manufacturer: manufacturer,
                    year: parseInt(year),
                    type: bikeType,
                    price: getRandomPrice(userPreferences.priceRange),
                    specs: {
                        weight: Math.floor(Math.random() * 10) + 5 + " kg",
                        material: getRandomMaterial(),
                        gears: Math.floor(Math.random() * 24) + 1
                    },
                    matchScore: Math.floor(Math.random() * 30) + 70,
                    image: getBikeImage(bikeType),
                    gender: gender,
                    freeShipping: Math.random() > 0.5
                };
                
                recommendedBikes.push(bike);
            }
        }
        
        // Calculate match score based on user preferences
        function calculateMatchScore(bikeData) {
            let score = 70; // Base score
            
            // Add points for matching preferences
            if (userPreferences.bikeType && bikeData.type === userPreferences.bikeType) {
                score += 10;
            }
            
            if (userPreferences.year && bikeData.year === parseInt(userPreferences.year)) {
                score += 10;
            }
            
            if (userPreferences.gender && (bikeData.gender === userPreferences.gender || bikeData.gender === 'unisex')) {
                score += 10;
            }
            
            // Add some randomness
            score += Math.floor(Math.random() * 10);
            
            // Cap at 100
            return Math.min(score, 100);
        }
        
        // Get random bike type
        function getRandomBikeType() {
            const types = ['road', 'mountain', 'hybrid', 'commuter', 'touring'];
            return types[Math.floor(Math.random() * types.length)];
        }
        
        // Get random gender
        function getRandomGender() {
            const genders = ['male', 'female', 'unisex'];
            return genders[Math.floor(Math.random() * genders.length)];
        }
        
        // Get random frame material
        function getRandomMaterial() {
            const materials = ['Carbon', 'Aluminum', 'Steel', 'Titanium'];
            return materials[Math.floor(Math.random() * materials.length)];
        }
        
        // Get random price based on price range
        function getRandomPrice(priceRange) {
            if (priceRange && PRICE_RANGES[priceRange]) {
                const range = PRICE_RANGES[priceRange];
                return Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;
            }
            
            // Default price range if none specified
            return Math.floor(Math.random() * 3000) + 300;
        }
        
        // Get bike image based on type
        function getBikeImage(type) {
            if (type && BIKE_IMAGES[type]) {
                return BIKE_IMAGES[type];
            }
            return BIKE_IMAGES.default;
        }
        
        // Display bikes in the bike list
        function displayBikes() {
            bikeList.innerHTML = '';
            
            if (recommendedBikes.length === 0) {
                bikeList.innerHTML = '<p>No bikes found matching your criteria. Please try different preferences.</p>';
                return;
            }
            
            recommendedBikes.forEach(bike => {
                const bikeCard = document.createElement('div');
                bikeCard.className = 'bike-card';
                bikeCard.dataset.bikeId = bike.id;
                
                bikeCard.innerHTML = `
                    <div class="bike-image">
                        <img src="${bike.image}" alt="${bike.manufacturer} ${bike.name}">
                        <div class="match-score">${bike.matchScore}% Match</div>
                        ${bike.freeShipping ? '<div class="free-shipping">Free Shipping</div>' : ''}
                    </div>
                    <div class="bike-details">
                        <div class="bike-year">${bike.year}</div>
                        <div class="bike-name">${bike.name}</div>
                        <div class="bike-manufacturer">${bike.manufacturer}</div>
                        <div class="price-tag">$${bike.price.toLocaleString()}</div>
                        <div class="rating"> (${Math.floor(Math.random() * 100) + 10})</div>
                        <div class="bike-spec">
                            <div>
                                <span class="spec-label">Weight</span>
                                <span class="spec-value">${bike.specs.weight}</span>
                            </div>
                            <div>
                                <span class="spec-label">Material</span>
                                <span class="spec-value">${bike.specs.material}</span>
                            </div>
                            <div>
                                <span class="spec-label">Gears</span>
                                <span class="spec-value">${bike.specs.gears}</span>
                            </div>
                        </div>
                    </div>
                `;
                
                bikeCard.addEventListener('click', () => showBikeDetails(bike));
                bikeList.appendChild(bikeCard);
            });
        }
        
        // Show bike details in modal
        function showBikeDetails(bike) {
            modalContent.innerHTML = `
                <h2>${bike.year} ${bike.manufacturer} ${bike.name}</h2>
                <div class="price-tag">$${bike.price.toLocaleString()}</div>
                <div class="rating"> (${Math.floor(Math.random() * 100) + 10} reviews)</div>
                
                <div style="display: flex; margin: 1.5rem 0; gap: 2rem; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px;">
                        <img src="${bike.image}" alt="${bike.manufacturer} ${bike.name}" style="max-width: 100%; border: 1px solid #ddd; padding: 1rem;">
                    </div>
                    <div style="flex: 1; min-width: 300px;">
                        <h3 class="section-title">Specifications</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Brand</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.manufacturer}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Model</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Year</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.year}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Type</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.type.charAt(0).toUpperCase() + bike.type.slice(1)}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Gender</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.gender.charAt(0).toUpperCase() + bike.gender.slice(1)}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Weight</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.specs.weight}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Frame Material</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.specs.material}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Gears</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.specs.gears}</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee; font-weight: 600;">Shipping</td>
                                <td style="padding: 0.5rem; border-bottom: 1px solid #eee;">${bike.freeShipping ? 'Free' : '$49.99'}</td>
                            </tr>
                        </table>
                        
                        <h3 class="section-title" style="margin-top: 1.5rem;">Purchase Options</h3>
                        <div class="purchase-options">
                            <a href="https://www.amazon.com/s?k=${encodeURIComponent(bike.manufacturer + ' ' + bike.name + ' ' + bike.type + ' bike')}" target="_blank" class="purchase-btn amazon">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon" style="height: 20px;">
                                <span>View on Amazon</span>
                            </a>
                            <a href="https://www.rei.com/search?q=${encodeURIComponent(bike.manufacturer + ' ' + bike.name)}" target="_blank" class="purchase-btn rei">
                                <img src="https://upload.wikimedia.org/wikipedia/en/thumb/9/9b/REI_logo.svg/170px-REI_logo.svg.png" alt="REI" style="height: 20px;">
                                <span>Check REI</span>
                            </a>
                            <a href="https://www.competitivecyclist.com/Store/catalog/search.jsp?q=${encodeURIComponent(bike.manufacturer + ' ' + bike.name)}" target="_blank" class="purchase-btn cc">
                                <span>Competitive Cyclist</span>
                            </a>
                            <a href="https://${bike.manufacturer.toLowerCase().replace(' ', '')}.com/search?q=${encodeURIComponent(bike.name)}" target="_blank" class="purchase-btn brand">
                                <span>Official ${bike.manufacturer} Store</span>
                            </a>
                            <a href="https://www.pinkbike.com/buysell/list/?q=${encodeURIComponent(bike.manufacturer + ' ' + bike.name)}" target="_blank" class="purchase-btn used">
                                <span>Find Used on PinkBike</span>
                            </a>
                    </div>
                        <p style="margin-top: 1rem; font-size: 0.85rem; color: #666;">
                            <em>* Note: Some affiliate commissions may be earned from purchases made through these links.</em>
                        </p>
                    </div>
                </div>
                
                <h3 class="section-title">Customer Reviews</h3>
                <div class="reviews-container" style="margin-bottom: 2rem;">
                    ${generateReviews(bike)}
                </div>
                
                <h3 class="section-title">Similar Bikes</h3>
                <div class="similar-bikes">
                    ${getSimilarBikes(bike)}
                </div>
            `;
            
            // Disable background scrolling
            document.body.classList.add('no-scroll');
            
            // Show modal
            bikeModal.style.display = 'block';
        }
        
        // Generate random reviews for a bike
        function generateReviews(bike) {
            const reviewCount = Math.floor(Math.random() * 5) + 3; // 3-7 reviews
            const reviewers = [
                'John D.', 'Sarah M.', 'Michael T.', 'Emma W.', 'David L.', 
                'Lisa K.', 'Robert P.', 'Jennifer S.', 'Thomas B.', 'Amanda C.'
            ];
            
            const reviewTitles = [
                'Great bike for the price!',
                'Exceeded my expectations',
                'Solid performance',
                'Perfect for my needs',
                'Impressive quality',
                'Good value',
                'Smooth ride',
                'Highly recommended',
                'Not bad, but could be better',
                'Excellent craftsmanship'
            ];
            
            const positiveComments = [
                `This ${bike.manufacturer} ${bike.name} is exactly what I was looking for. The ${bike.specs.material} frame is lightweight yet durable.`,
                `I've been riding this bike for about a month now and I'm very impressed with its performance. Shifting is smooth and the brakes are responsive.`,
                `The ${bike.name} handles well on various terrains. I use it primarily for commuting and weekend rides, and it's perfect for both.`,
                `Assembly was straightforward and the bike arrived in perfect condition. The ${bike.specs.material} frame feels solid and well-built.`,
                `This is my second ${bike.manufacturer} bike and they never disappoint. The quality and attention to detail is outstanding.`,
                `Great value for a ${bike.year} model. Rides smoothly and looks fantastic. I get compliments on it all the time.`,
                `The ${bike.specs.gears} gears provide plenty of range for both flat roads and steep hills. Very versatile bike.`,
                `I was hesitant to buy a bike online, but this ${bike.name} exceeded my expectations. Shipping was fast and the bike was easy to set up.`
            ];
            
            const mixedComments = [
                `Overall a good bike, but the seat is a bit uncomfortable for longer rides. I replaced it with a gel seat and now it's perfect.`,
                `The ${bike.name} is a solid bike for the price, but the paint job has a few imperfections. Not a deal-breaker though.`,
                `Good performance on roads, but I wouldn't recommend it for serious off-road trails. The tires aren't quite up to the task.`,
                `Nice bike with good components, but the assembly instructions could be clearer. Had to look up a few things online.`,
                `The bike is lighter than I expected, which is great for transport, but makes me a bit concerned about durability for rough terrain.`
            ];
            
            let reviewsHTML = '';
            
            for (let i = 0; i < reviewCount; i++) {
                const reviewer = reviewers[Math.floor(Math.random() * reviewers.length)];
                const reviewTitle = reviewTitles[Math.floor(Math.random() * reviewTitles.length)];
                const rating = Math.floor(Math.random() * 2) + 4; // 4-5 stars mostly
                const date = new Date();
                date.setDate(date.getDate() - Math.floor(Math.random() * 90)); // Random date within last 90 days
                const formattedDate = date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                
                // 80% chance of positive comment, 20% chance of mixed comment
                const comment = Math.random() < 0.8 ? 
                    positiveComments[Math.floor(Math.random() * positiveComments.length)] : 
                    mixedComments[Math.floor(Math.random() * mixedComments.length)];
                
                const stars = ''.repeat(rating) + ''.repeat(5 - rating);
                
                reviewsHTML += `
                    <div style="border-bottom: 1px solid #eee; padding: 1rem 0; margin-bottom: 0.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div style="font-weight: 600; font-size: 1.1rem;">${reviewTitle}</div>
                            <div style="color: var(--primary); font-size: 1.1rem;">${stars}</div>
                        </div>
                        <div style="margin-bottom: 0.5rem; font-size: 0.9rem; color: #666;">
                            By ${reviewer} on ${formattedDate}
                        </div>
                        <p style="line-height: 1.5;">${comment}</p>
                        <div style="margin-top: 0.8rem; font-size: 0.85rem;">
                            <span style="color: var(--primary); cursor: pointer;">Helpful (${Math.floor(Math.random() * 20)})</span> | 
                            <span style="cursor: pointer;" onclick="reportReview('${reviewer}')">Report</span>
                        </div>
                    </div>
                `;
            }
            
            reviewsHTML += `
                <div style="margin-top: 1.5rem;">
                    <button style="background-color: #f8f8f8; border: 1px solid #ddd; padding: 0.7rem 1.2rem; border-radius: 4px; cursor: pointer; font-weight: 500; transition: all 0.2s;">
                        Write a Review
                    </button>
                    <button style="background-color: transparent; border: none; padding: 0.7rem 1.2rem; cursor: pointer; color: var(--primary); font-weight: 500; transition: all 0.2s;">
                        See All Reviews (${Math.floor(Math.random() * 50) + reviewCount})
                    </button>
                </div>
            `;
            
            return reviewsHTML;
        }
        
        // Function to handle report clicks
        function reportReview(reviewer) {
            alert(`The ${reviewer} has been obliterated their house has been taken and they have been bombed`);
        }
        
        // Get similar bikes HTML
        function getSimilarBikes(currentBike) {
            // Filter bikes of same type but different models
            const similar = recommendedBikes
                .filter(bike => bike.type === currentBike.type && bike.id !== currentBike.id)
                .slice(0, 5);
                
            if (similar.length === 0) {
                return '<p>No similar bikes found.</p>';
            }
            
            return similar.map(bike => `
                <div class="similar-bike-card" data-bike-id="${bike.id}" onclick="showBikeById('${bike.id}')">
                    <div style="height: 120px; display: flex; align-items: center; justify-content: center; padding: 0.5rem; border-bottom: 1px solid #eee;">
                        <img src="${bike.image}" alt="${bike.name}" style="max-height: 100px; max-width: 100%;">
                    </div>
                    <div style="padding: 0.5rem;">
                        <div style="font-size: 0.8rem; color: #666;">${bike.year}</div>
                        <div style="font-weight: 600; font-size: 0.9rem;">${bike.name}</div>
                        <div style="font-size: 0.8rem;">${bike.manufacturer}</div>
                        <div style="color: var(--danger); font-weight: 600; margin-top: 0.3rem;">$${bike.price.toLocaleString()}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // Show bike details by ID with smooth scroll and fade transition
        function showBikeById(bikeId) {
            const bike = recommendedBikes.find(bike => bike.id === bikeId);
            if (bike) {
                // Fade out current content
                const currentContent = document.getElementById('modal-content');
                currentContent.style.opacity = '0';
                
                // Smooth scroll to top
                const modalContent = document.querySelector('.modal-content');
                modalContent.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                
                // Wait for fade out and scroll, then update content
                setTimeout(() => {
                    showBikeDetails(bike);
                    // Ensure body still has no-scroll class
                    document.body.classList.add('no-scroll');
                    // Fade in new content
                    setTimeout(() => {
                        document.getElementById('modal-content').style.opacity = '1';
                    }, 50);
                }, 300);
            }
        }
        
        // Sort bikes based on selected sort option
        function sortBikes() {
            const sortBy = sortBySelect.value;
            
            switch (sortBy) {
                case 'match':
                    recommendedBikes.sort((a, b) => b.matchScore - a.matchScore);
                    break;
                case 'price-low':
                    recommendedBikes.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    recommendedBikes.sort((a, b) => b.price - a.price);
                    break;
                case 'year':
                    recommendedBikes.sort((a, b) => b.year - a.year);
                    break;
                default:
                    recommendedBikes.sort((a, b) => b.matchScore - a.matchScore);
            }
            
            // Re-display bikes with new sort order
            if (bikeList.innerHTML !== '') {
                displayBikes();
            }
        }
    </script>
    
    <!-- Intro Animation Script -->
    <script>
        // Create intro section elements
        document.addEventListener('DOMContentLoaded', function() {
            // Create intro section if it doesn't exist
            if (!document.querySelector('.intro-section')) {
                const introSection = document.createElement('div');
                introSection.className = 'intro-section';
                
                introSection.innerHTML = `
                    <div class="animation-container" id="bike-animation"></div>
                    <h1 class="intro-title">BikeMatch</h1>
                    <p class="intro-subtitle">Finding your perfect ride has never been easier. Discover bikes tailored to your preferences.</p>
                    <button class="skip-intro">Skip Intro</button>
                    <div class="scroll-indicator">
                        <p>Scroll to explore</p>
                        <div class="scroll-arrow"></div>
                    </div>
                `;
                
                document.body.prepend(introSection);
                
                // Initialize Lottie animation
                initBikeAnimation();
                
                // Add event listeners
                setupIntroEvents();
            }
        });
        
        // Initialize the bike animation using Lottie
        function initBikeAnimation() {
            const animContainer = document.getElementById('bike-animation');
            
            // Create dotlottie-player element
            const dotLottiePlayer = document.createElement('dotlottie-player');
            dotLottiePlayer.setAttribute('src', 'https://lottie.host/e5373f4a-a3bc-4952-b08c-6baae5f3c83f/ccAtJBcdJG.lottie');
            dotLottiePlayer.setAttribute('background', 'transparent');
            dotLottiePlayer.setAttribute('speed', '1');
            dotLottiePlayer.setAttribute('style', 'width: 100%; height: 100%');
            dotLottiePlayer.setAttribute('loop', '');
            dotLottiePlayer.setAttribute('autoplay', '');
            
            // Clear container and append player
            animContainer.innerHTML = '';
            animContainer.appendChild(dotLottiePlayer);
            
            // Add error handling
            dotLottiePlayer.addEventListener('error', function(event) {
                console.error('dotLottie player error:', event);
                tryFallbackAnimation();
            });
            
            // Set animation duration
            const animationDuration = 6000; // 6 seconds
            
            // Auto-transition after animation completes if user hasn't scrolled
            setTimeout(() => {
                if (window.scrollY < 50) { // If user hasn't scrolled yet
                    autoTransitionToMain();
                }
            }, animationDuration);
        }
        
        // Function to try fallback animations in sequence
        function tryFallbackAnimation() {
            const animContainer = document.getElementById('bike-animation');
            
            try {
                // First try standard Lottie animation as fallback
                animContainer.innerHTML = '';
                
                const fallbackOptions = {
                    container: animContainer,
                    renderer: 'svg',
                    loop: true,
                    autoplay: true,
                    path: 'https://assets9.lottiefiles.com/animations/Gy0nzY3PPg.json',
                    rendererSettings: {
                        preserveAspectRatio: 'xMidYMid slice'
                    }
                };
                
                const fallbackAnim = lottie.loadAnimation(fallbackOptions);
                
                fallbackAnim.addEventListener('error', function() {
                    console.log('Error loading first fallback, trying second fallback');
                    fallbackAnim.destroy();
                    trySecondFallback();
                });
            } catch (error) {
                console.error('Fallback animation error:', error);
                trySecondFallback();
            }
        }
        
        // Second fallback option
        function trySecondFallback() {
            const animContainer = document.getElementById('bike-animation');
            
            try {
                animContainer.innerHTML = '';
                
                const secondFallbackOptions = {
                    container: animContainer,
                    renderer: 'svg',
                    loop: true,
                    autoplay: true,
                    path: 'https://assets3.lottiefiles.com/packages/lf20_qs1nybeq.json',
                    rendererSettings: {
                        preserveAspectRatio: 'xMidYMid slice'
                    }
                };
                
                const secondFallbackAnim = lottie.loadAnimation(secondFallbackOptions);
                
                secondFallbackAnim.addEventListener('error', function() {
                    console.log('Error loading second fallback, using static image');
                    secondFallbackAnim.destroy();
                    useStaticImage();
                });
            } catch (error) {
                console.error('Second fallback animation error:', error);
                useStaticImage();
            }
        }
        
        // Last resort - use static image
        function useStaticImage() {
            const animContainer = document.getElementById('bike-animation');
            if (animContainer) {
                animContainer.innerHTML = '<img src="https://images.unsplash.com/photo-1485965120184-e220f721d03e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Bicycle" style="max-width: 100%; max-height: 100%;">';
            }
        }
        
        // Setup event listeners for intro section
        function setupIntroEvents() {
            const introSection = document.querySelector('.intro-section');
            const skipIntroBtn = document.querySelector('.skip-intro');
            const mainContent = document.querySelector('.main-content');
            
            // Initially prevent scrolling on body
            document.body.style.overflow = 'hidden';
            
            // Skip intro button click
            skipIntroBtn.addEventListener('click', () => {
                autoTransitionToMain();
            });
            
            // Allow scrolling to dismiss the intro
            let startY = 0;
            let scrollAttempts = 0;
            
            // Touch events for mobile
            document.addEventListener('touchstart', (e) => {
                if (introSection.style.display !== 'none') {
                    startY = e.touches[0].clientY;
                }
            }, { passive: true });
            
            document.addEventListener('touchmove', (e) => {
                if (introSection.style.display !== 'none') {
                    const currentY = e.touches[0].clientY;
                    if (startY > currentY) { // Scrolling down
                        scrollAttempts++;
                        if (scrollAttempts > 2) { // Require a bit more scrolling to trigger
                            handleScroll();
                        }
                    }
                }
            }, { passive: true });
            
            // Mouse wheel event for desktop
            document.addEventListener('wheel', (e) => {
                if (introSection.style.display !== 'none' && e.deltaY > 0) {
                    scrollAttempts++;
                    if (scrollAttempts > 1) { // Require a bit more scrolling to trigger
                        handleScroll();
                    }
                }
            }, { passive: true });
            
            // Handle scroll action
            function handleScroll() {
                // Add fading class to disable pointer events
                introSection.classList.add('fading');
                
                // Start fading out the intro
                introSection.style.opacity = '0';
                
                // After fade out, hide intro and enable normal scrolling
                setTimeout(() => {
                    introSection.style.display = 'none';
                    document.body.style.overflow = '';
                    scrollAttempts = 0;
                }, 800);
            }
        }
        
        // Auto transition to main content
        function autoTransitionToMain() {
            const introSection = document.querySelector('.intro-section');
            
            // Add fading class to disable pointer events
            introSection.classList.add('fading');
            
            // Fade out intro section
            introSection.style.opacity = '0';
            
            // After fade out, hide intro and enable normal scrolling
            setTimeout(() => {
                introSection.style.display = 'none';
                document.body.style.overflow = ''; // Re-enable scrolling
            }, 800);
        }
    </script>
</body>
</html>
